"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5032],{3448:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>u,default:()=>b,frontMatter:()=>o,metadata:()=>c,toc:()=>g});var a=t(1948),r=t(3460),s=t(302),i=t(240),l=t(2548);const o={title:"Debugging"},u=void 0,c={id:"debug",title:"Debugging",description:"Lightweight debugging. Wraps the amazing debug library to",source:"@site/docs/debug.mdx",sourceDirName:".",slug:"/debug",permalink:"/docs/debug",draft:!1,unlisted:!1,editUrl:"https://github.com/milesj/boost/edit/master/website/docs/debug.mdx",tags:[],version:"current",frontMatter:{title:"Debugging"},sidebar:"docs",previous:{title:"Crash reporting",permalink:"/docs/crash"},next:{title:"Decorators",permalink:"/docs/decorators"}},d={},g=[{value:"Installation",id:"installation",level:2},{value:"Environment variables",id:"environment-variables",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Invariant messages",id:"invariant-messages",level:3},{value:"Verbose output",id:"verbose-output",level:3},{value:"Silencing output",id:"silencing-output",level:3},{value:"Test utilities",id:"test-utilities",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.c,{backend:!0,tooling:!0,api:"/api/debug"}),"\n",(0,a.jsxs)(n.p,{children:["Lightweight debugging. Wraps the amazing ",(0,a.jsx)(n.a,{href:"https://www.npmjs.com/package/debug",children:"debug"})," library to\nprovide additional functionality."]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsxs)(i.c,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"pnpm",value:"pnpm"},{label:"npm",value:"npm"}],children:[(0,a.jsx)(l.c,{value:"yarn",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"yarn add @boost/debug\n"})})}),(0,a.jsx)(l.c,{value:"pnpm",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pnpm add @boost/debug\n"})})}),(0,a.jsx)(l.c,{value:"npm",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install @boost/debug\n"})})})]}),"\n",(0,a.jsx)(n.h2,{id:"environment-variables",children:"Environment variables"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"BOOSTJS_DEBUG_NAMESPACE"})," (",(0,a.jsx)(n.code,{children:"string"}),") - A prefix for all debugger namespaces when created with\n",(0,a.jsx)(n.code,{children:"createDebugger()"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"BOOSTJS_DEBUG_VERBOSE"})," (",(0,a.jsx)(n.code,{children:"boolean"}),") - Print verbose messages logged from ",(0,a.jsx)(n.code,{children:"debugger.verbose()"}),",\notherwise they are hidden."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,a.jsxs)(n.p,{children:["Like ",(0,a.jsx)(n.a,{href:"/docs/log",children:"logging"}),', a "debugger" is a collection of functions that write to ',(0,a.jsx)(n.code,{children:"process.stderr"}),".\nThe key difference is that debug messages are only displayed if the ",(0,a.jsx)(n.code,{children:"DEBUG"})," environment variable is\nset and contains the debugger's namespace (logic provided by the\n",(0,a.jsx)(n.a,{href:"https://www.npmjs.com/package/debug",children:"debug"})," package). The namespace can be defined when\ninstantiating a debugger using ",(0,a.jsx)(n.a,{href:"/api/debug/function/createDebugger",children:(0,a.jsx)(n.code,{children:"createDebugger"})}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"import { createDebugger } from '@boost/debug';\n\nconst debug = createDebugger('boost');\n\nprocess.env.DEBUG = 'boost:*';\n\ndebug('Something is broken!');\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"A namespace can either be a string or an array of strings."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Each debug function that logs (excluding invariants) requires a message string as the 1st argument,\nand an optional rest of arguments to interpolate into the message using\n",(0,a.jsx)(n.a,{href:"https://nodejs.org/api/util.html#util_util_format_format_args",children:(0,a.jsx)(n.code,{children:"util.format()"})}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"debug('Name: %s %s', user.first_name, user.last_name);\ndebug('Object: %O', data);\n"})}),"\n",(0,a.jsx)(n.h3,{id:"invariant-messages",children:"Invariant messages"}),"\n",(0,a.jsxs)(n.p,{children:["Invariant debugging logs either a success or a failure message, depending on the truthy evaluation\nof a condition. This can be achieved with\n",(0,a.jsx)(n.a,{href:"/api/debug/interface/Debugger#invariant",children:(0,a.jsx)(n.code,{children:"debugger.invariant()"})}),", which requires the condition to\nevaluate, a message to always display, and a success and failure message."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"debug.invariant(fs.existsSync(filePath), 'Does file exist?', 'Yes!', 'No');\n"})}),"\n",(0,a.jsx)(n.h3,{id:"verbose-output",children:"Verbose output"}),"\n",(0,a.jsxs)(n.p,{children:["Debug messages are already hidden behind the ",(0,a.jsx)(n.code,{children:"DEBUG"})," environment variable, but Boost takes it a step\nfurther to support verbose debugging. Messages logged with\n",(0,a.jsx)(n.a,{href:"/api/debug/interface/Debugger#verbose",children:(0,a.jsx)(n.code,{children:"debugger.verbose()"})})," will not be displayed unless the\n",(0,a.jsx)(n.code,{children:"BOOSTJS_DEBUG_VERBOSE"})," environment variable is set -- even if ",(0,a.jsx)(n.code,{children:"DEBUG"})," is set."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"// Will not write!\ndebug.verbose('We need extra information');\n\nprocess.env.BOOSTJS_DEBUG_VERBOSE = 'true';\n\n// Will write!\ndebug.verbose('We need extra information (again)');\n"})}),"\n",(0,a.jsx)(n.h3,{id:"silencing-output",children:"Silencing output"}),"\n",(0,a.jsxs)(n.p,{children:["By default, all logged messages are immediately written when ",(0,a.jsx)(n.code,{children:"DEBUG"})," contains the debugger\nnamespace. To silence output for a specific debugger, call the\n",(0,a.jsx)(n.a,{href:"/api/debug/interface/Debugger#disable",children:(0,a.jsx)(n.code,{children:"debugger.disable()"})})," function, and to re-enable, call\n",(0,a.jsx)(n.a,{href:"/api/debug/interface/Debugger#enable",children:(0,a.jsx)(n.code,{children:"debugger.enable()"})}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"debug.disable();\n\n// Will not write!\ndebug('Something is broken!');\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Messages that are logged while silenced are ",(0,a.jsx)(n.em,{children:"lost"})," and are ",(0,a.jsx)(n.em,{children:"not"})," buffered."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"test-utilities",children:"Test utilities"}),"\n",(0,a.jsxs)(n.p,{children:["A handful of ",(0,a.jsx)(n.a,{href:"https://vitest.dev/",children:"Vitest"})," utilities are available in the ",(0,a.jsx)(n.code,{children:"@boost/debug/test"}),"\nmodule. ",(0,a.jsx)(n.a,{href:"/api/debug-test",children:"View the API for a full list"}),"."]})]})}function b(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},2548:(e,n,t)=>{t.d(n,{c:()=>i});t(6952);var a=t(8112);const r={tabItem:"tabItem_wHwb"};var s=t(1948);function i(e){let{children:n,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.c)(r.tabItem,i),hidden:t,children:n})}},240:(e,n,t)=>{t.d(n,{c:()=>h});var a=t(6952),r=t(8112),s=t(320),i=t(500),l=t(6576);const o={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var u=t(1948);function c(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.MV)(),g=e=>{const n=e.currentTarget,t=c.indexOf(n),r=l[t].value;r!==a&&(d(n),i(r))},h=e=>{var n;let t=null;switch(e.key){case"Enter":g(e);break;case"ArrowRight":{var a;const n=c.indexOf(e.currentTarget)+1;t=null!=(a=c[n])?a:c[0];break}case"ArrowLeft":{var r;const n=c.indexOf(e.currentTarget)-1;t=null!=(r=c[n])?r:c[c.length-1];break}}null==(n=t)||n.focus()};return(0,u.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.c)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,u.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>c.push(e),onKeyDown:h,onClick:g,...s,className:(0,r.c)("tabs__item",o.tabItem,null==s?void 0:s.className,{"tabs__item--active":a===n}),children:null!=t?t:n},n)}))})}function d(e){let{lazy:n,children:t,selectedValue:r}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,u.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function g(e){const n=(0,i.a)(e);return(0,u.jsxs)("div",{className:(0,r.c)("tabs-container",o.tabList),children:[(0,u.jsx)(c,{...e,...n}),(0,u.jsx)(d,{...e,...n})]})}function h(e){const n=(0,l.c)();return(0,u.jsx)(g,{...e,children:(0,i.A)(e.children)},String(n))}},500:(e,n,t)=>{t.d(n,{A:()=>u,a:()=>h});var a=t(6952),r=t(7976),s=t(2508),i=t(440),l=t(2484),o=t(900);function u(e){var n,t;return null!=(n=null==(t=a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function c(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=null!=n?n:function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,l.w)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function d(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const s=(0,r.Uz)(),l=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,i._M)(l),(0,a.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(s.location.search);n.set(l,e),s.replace({...s.location,search:n.toString()})}),[l,s])]}function h(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,i=c(e),[l,u]=(0,a.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+a.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const r=null!=(n=a.find((e=>e.default)))?n:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:i}))),[h,b]=g({queryString:t,groupId:r}),[p,m]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[r,s]=(0,o.IN)(t);return[r,(0,a.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),f=(()=>{const e=null!=h?h:p;return d({value:e,tabValues:i})?e:null})();(0,s.c)((()=>{f&&u(f)}),[f]);return{selectedValue:l,selectValue:(0,a.useCallback)((e=>{if(!d({value:e,tabValues:i}))throw new Error("Can't select invalid tab value="+e);u(e),b(e),m(e)}),[b,m,i]),tabValues:i}}},5392:(e,n,t)=>{t.d(n,{c:()=>r});var a=t(1948);function r(e){let{children:n,type:t}=e;return(0,a.jsx)("span",{className:"badge badge--"+t,children:n})}},302:(e,n,t)=>{t.d(n,{c:()=>u});var a=t(4308),r=t(3752),s=t(5392);const i={badgeGroup:"badgeGroup_syf7",apiLink:"apiLink_JWAN"};var l=t(1948);function o(e){let{children:n}=e;return(0,l.jsx)("span",{className:i.badgeGroup,children:n})}function u(e){let{api:n,backend:t,frontend:u,tooling:c}=e;return(0,l.jsxs)(l.Fragment,{children:[n&&(0,l.jsxs)(a.default,{className:i.apiLink,to:n,children:["API ",(0,l.jsx)(r.c,{})]}),(0,l.jsxs)(o,{children:[t&&(0,l.jsx)(s.c,{type:"warning",children:"Backend"}),u&&(0,l.jsx)(s.c,{type:"success",children:"Frontend"}),c&&(0,l.jsx)(s.c,{type:"primary",children:"Tooling"})]})]})}},3460:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>i});var a=t(6952);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);