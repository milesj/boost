(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[452],{5318:function(e,n,t){"use strict";t.d(n,{Zo:function(){return c},kt:function(){return d}});var r=t(7378);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var o=r.createContext({}),u=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=u(e.components);return r.createElement(o.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=u(t),d=a,v=m["".concat(o,".").concat(d)]||m[d]||p[d]||i;return t?r.createElement(v,l(l({ref:n},c),{},{components:t})):r.createElement(v,l({ref:n},c))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,l=new Array(i);l[0]=m;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var u=2;u<i;u++)l[u]=t[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},517:function(e,n,t){"use strict";var r=t(7378);n.Z=function(e){var n=e.children,t=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:a},n)}},4535:function(e,n,t){"use strict";t.d(n,{Z:function(){return p}});var r=t(7378),a=t(4956);var i=function(){var e=(0,r.useContext)(a.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},l=t(8944),s="tabItem_c0e5",o="tabItemActive_28AG";var u=37,c=39;var p=function(e){var n=e.lazy,t=e.block,a=e.defaultValue,p=e.values,m=e.groupId,d=e.className,v=i(),f=v.tabGroupChoices,g=v.setTabGroupChoices,h=(0,r.useState)(a),b=h[0],k=h[1],y=r.Children.toArray(e.children),E=[];if(null!=m){var N=f[m];null!=N&&N!==b&&p.some((function(e){return e.value===N}))&&k(N)}var w=function(e){var n=e.currentTarget,t=E.indexOf(n),r=p[t].value;k(r),null!=m&&(g(m,r),setTimeout((function(){var e,t,r,a,i,l,s,u;(e=n.getBoundingClientRect(),t=e.top,r=e.left,a=e.bottom,i=e.right,l=window,s=l.innerHeight,u=l.innerWidth,t>=0&&i<=u&&a<=s&&r>=0)||(n.scrollIntoView({block:"center",behavior:"smooth"}),n.classList.add(o),setTimeout((function(){return n.classList.remove(o)}),2e3))}),150))},C=function(e){var n,t;switch(e.keyCode){case c:var r=E.indexOf(e.target)+1;t=E[r]||E[0];break;case u:var a=E.indexOf(e.target)-1;t=E[a]||E[E.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},d)},p.map((function(e){var n=e.value,t=e.label;return r.createElement("li",{role:"tab",tabIndex:b===n?0:-1,"aria-selected":b===n,className:(0,l.Z)("tabs__item",s,{"tabs__item--active":b===n}),key:n,ref:function(e){return E.push(e)},onKeyDown:C,onFocus:w,onClick:w},t)}))),n?(0,r.cloneElement)(y.filter((function(e){return e.props.value===b}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},y.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==b})}))))}},4956:function(e,n,t){"use strict";var r=(0,t(7378).createContext)(void 0);n.Z=r},297:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(7378);function a(e){var n=e.children,t=e.type;return r.createElement("span",{className:"badge badge--"+t},n)}},7586:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(7378),a=t(297),i="badgeGroup_2HOO";function l(e){var n=e.children;return r.createElement("span",{className:i},n)}function s(e){var n=e.backend,t=e.frontend,i=e.tooling;return r.createElement(l,null,n&&r.createElement(a.Z,{type:"warning"},"Backend"),t&&r.createElement(a.Z,{type:"success"},"Frontend"),i&&r.createElement(a.Z,{type:"primary"},"Tooling"))}},9213:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return c},contentTitle:function(){return p},metadata:function(){return m},toc:function(){return d},default:function(){return f}});var r=t(9603),a=t(120),i=(t(7378),t(5318)),l=t(7586),s=t(4535),o=t(517),u=["components"],c={title:"Events"},p=void 0,m={unversionedId:"event",id:"event",isDocsHomePage:!1,title:"Events",description:"A type-safe event system with multiple emitter patterns.",source:"@site/docs/event.mdx",sourceDirName:".",slug:"/event",permalink:"/docs/event",editUrl:"https://github.com/milesj/boost/edit/master/website/docs/event.mdx",version:"current",frontMatter:{title:"Events"},sidebar:"docs",previous:{title:"Decorators",permalink:"/docs/decorators"},next:{title:"Logging",permalink:"/docs/log"}},d=[{value:"Installation",id:"installation",children:[]},{value:"Events",id:"events",children:[{value:"Registering listeners",id:"registering-listeners",children:[]},{value:"Unregistering listeners",id:"unregistering-listeners",children:[]},{value:"Emitting events",id:"emitting-events",children:[]}]},{value:"Scopes",id:"scopes",children:[]},{value:"Event types",id:"event-types",children:[{value:"<code>Event</code>",id:"event",children:[]},{value:"<code>BailEvent</code>",id:"bailevent",children:[]},{value:"<code>ConcurrentEvent</code>",id:"concurrentevent",children:[]},{value:"<code>WaterfallEvent</code>",id:"waterfallevent",children:[]}]}],v={toc:d};function f(e){var n=e.components,t=(0,a.Z)(e,u);return(0,i.kt)("wrapper",(0,r.Z)({},v,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{backend:!0,frontend:!0,tooling:!0,mdxType:"EnvBadges"}),(0,i.kt)("p",null,"A type-safe event system with multiple emitter patterns."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)(s.Z,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"NPM",value:"npm"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @boost/event\n"))),(0,i.kt)(o.Z,{value:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @boost/event\n")))),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("p",null,"The event system is built around individual ",(0,i.kt)("inlineCode",{parentName:"p"},"Event")," classes that can be instantiated in isolation,\nregister and unregister their own listeners, and emit values by executing each listener with\narguments. There are multiple ",(0,i.kt)("a",{parentName:"p",href:"#types"},"types of events"),", so choose the best one for each use case."),(0,i.kt)("p",null,"To begin using events, instantiate an ",(0,i.kt)("inlineCode",{parentName:"p"},"Event")," with a unique name -- the name is purely for debugging\npurposes."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Event } from '@boost/event';\n\nconst event = new Event<[string]>('example');\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Event"),"s utilize TypeScript generics for typing the arguments passed to listener functions. This can\nbe defined using a tuple or an array in the 1st generic slot. The 2nd slot is reserved for\n",(0,i.kt)("a",{parentName:"p",href:"#scopes"},"scopes"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"// One argument of type number\nnew Event<[number]>('foo');\n\n// Two arguments of type number and string\nnew Event<[number, string]>('bar');\n\n// Three arguments with the last item being optional\nnew Event<[object, boolean, string?]>('baz');\n\n// Array of any type or size\nnew Event<unknown[]>('foo');\n")),(0,i.kt)("h3",{id:"registering-listeners"},"Registering listeners"),(0,i.kt)("p",null,"Listeners are simply functions that can be registered to an event using ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#listen()"),". The same\nlistener function reference will only be registered once."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"event.listen(listener);\n")),(0,i.kt)("p",null,"A listener can also be registered to execute only once, using ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#once()"),", regardless of how many\ntimes the event has been emitted."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"event.once(listener);\n")),(0,i.kt)("h3",{id:"unregistering-listeners"},"Unregistering listeners"),(0,i.kt)("p",null,"A listener can be unregistered from an event using ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#unlisten()"),". The same listener reference\nused to register must also be used for unregistering."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"event.unlisten(listener);\n")),(0,i.kt)("p",null,"To make this flow easier, a pre-configured unlistener is returned from ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#listen()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const unlisten = event.listen(listener);\nunlisten();\n")),(0,i.kt)("h3",{id:"emitting-events"},"Emitting events"),(0,i.kt)("p",null,"Emitting is the concept of executing all registered listeners with a set of arguments. This can be\nachieved through the ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#emit()")," method, which requires an array of values to pass to each\nlistener as arguments."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"event.emit(['abc']);\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The array values and its types should match the ",(0,i.kt)("a",{parentName:"p",href:"#events"},"generics defined")," on the constructor.")),(0,i.kt)("h2",{id:"scopes"},"Scopes"),(0,i.kt)("p",null,"Scopes are a mechanism for restricting listeners to a unique subset. Scopes are defined as the 2nd\nargument to ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#listen()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"unlisten()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"once()"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"emit()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"event.listen(listener);\nevent.listen(listener, 'foo');\nevent.listen(listener, 'bar');\n\n// Will only execute the 1st listener\nevent.emit([]);\n\n// Will only execute the 2nd listener\nevent.emit([], 'foo');\n")),(0,i.kt)("p",null,"A list of acceptable scope names can be passed as the 2nd generic slot to ",(0,i.kt)("inlineCode",{parentName:"p"},"Event"),", otherwise all\nstrings are allowed."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"new Event<[number], 'foo' | 'bar' | 'baz'>('event');\n")),(0,i.kt)("h2",{id:"event-types"},"Event types"),(0,i.kt)("p",null,"There are 4 types of events that can be instantiated and emitted."),(0,i.kt)("h3",{id:"event"},(0,i.kt)("inlineCode",{parentName:"h3"},"Event")),(0,i.kt)("p",null,"Standard event that executes listeners in the order they were registered."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Event } from '@boost/event';\n\nconst event = new Event<[string, number]>('standard');\n\nevent.listen(listener);\n\nevent.emit(['abc', 123]);\n")),(0,i.kt)("h3",{id:"bailevent"},(0,i.kt)("inlineCode",{parentName:"h3"},"BailEvent")),(0,i.kt)("p",null,"Like ",(0,i.kt)("inlineCode",{parentName:"p"},"Event")," but can bail the execution loop early if a listener returns ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"emit")," method\nwill return ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," if a bail occurs."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { BailEvent } from '@boost/event';\n\nconst event = new BailEvent<[object]>('bail');\n\n// Will execute\nevent.listen(() => {});\n\n// Will execute and bail\nevent.listen(() => false);\n\n// Will not execute\nevent.listen(() => {});\n\nconst bailed = event.emit([{ example: true }]);\n")),(0,i.kt)("h3",{id:"concurrentevent"},(0,i.kt)("inlineCode",{parentName:"h3"},"ConcurrentEvent")),(0,i.kt)("p",null,"Executes listeners in parallel and returns a promise with the result of all listeners."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { ConcurrentEvent } from '@boost/event';\n\nconst event = new ConcurrentEvent<[]>('parallel');\n\nevent.listen(doHeavyProcess);\nevent.listen(doBackgroundJob);\n\n// Async/await\nconst result = await event.emit([]);\n\n// Promise\nevent.emit([]).then((result) => {});\n")),(0,i.kt)("h3",{id:"waterfallevent"},(0,i.kt)("inlineCode",{parentName:"h3"},"WaterfallEvent")),(0,i.kt)("p",null,"Executes each listener in order, passing the previous listeners return value as an argument to the\nnext listener."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { WaterfallEvent } from '@boost/event';\n\nconst event = new WaterfallEvent<number>('waterfall');\n\nevent.listen((num) => num * 2);\nevent.listen((num) => num * 3);\n\nconst result = event.emit(10); // 60\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This event only accepts a single argument. The generic type should not be an array, as it types\nthe only argument and the return type.")))}f.isMDXComponent=!0},8944:function(e,n,t){"use strict";function r(e){var n,t,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=r(e[n]))&&(a&&(a+=" "),a+=t);else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function a(){for(var e,n,t=0,a="";t<arguments.length;)(e=arguments[t++])&&(n=r(e))&&(a&&(a+=" "),a+=n);return a}t.d(n,{Z:function(){return a}})}}]);