(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[62],{5318:function(e,n,t){"use strict";t.d(n,{Zo:function(){return p},kt:function(){return c}});var a=t(7378);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),d=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=d(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(t),c=o,f=m["".concat(s,".").concat(c)]||m[c]||u[c]||i;return t?a.createElement(f,r(r({ref:n},p),{},{components:t})):a.createElement(f,r({ref:n},p))}));function c(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=t[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},517:function(e,n,t){"use strict";var a=t(7378);n.Z=function(e){var n=e.children,t=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",hidden:t,className:o},n)}},4535:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var a=t(7378),o=t(4956);var i=function(){var e=(0,a.useContext)(o.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},r=t(8944),l="tabItem_c0e5",s="tabItemActive_28AG";var d=37,p=39;var u=function(e){var n=e.lazy,t=e.block,o=e.defaultValue,u=e.values,m=e.groupId,c=e.className,f=i(),g=f.tabGroupChoices,k=f.setTabGroupChoices,h=(0,a.useState)(o),b=h[0],N=h[1],v=a.Children.toArray(e.children),C=[];if(null!=m){var y=g[m];null!=y&&y!==b&&u.some((function(e){return e.value===y}))&&N(y)}var w=function(e){var n=e.currentTarget,t=C.indexOf(n),a=u[t].value;N(a),null!=m&&(k(m,a),setTimeout((function(){var e,t,a,o,i,r,l,d;(e=n.getBoundingClientRect(),t=e.top,a=e.left,o=e.bottom,i=e.right,r=window,l=r.innerHeight,d=r.innerWidth,t>=0&&i<=d&&o<=l&&a>=0)||(n.scrollIntoView({block:"center",behavior:"smooth"}),n.classList.add(s),setTimeout((function(){return n.classList.remove(s)}),2e3))}),150))},x=function(e){var n,t;switch(e.keyCode){case p:var a=C.indexOf(e.target)+1;t=C[a]||C[0];break;case d:var o=C.indexOf(e.target)-1;t=C[o]||C[C.length-1]}null==(n=t)||n.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},c)},u.map((function(e){var n=e.value,t=e.label;return a.createElement("li",{role:"tab",tabIndex:b===n?0:-1,"aria-selected":b===n,className:(0,r.Z)("tabs__item",l,{"tabs__item--active":b===n}),key:n,ref:function(e){return C.push(e)},onKeyDown:x,onFocus:w,onClick:w},t)}))),n?(0,a.cloneElement)(v.filter((function(e){return e.props.value===b}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},v.map((function(e,n){return(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==b})}))))}},4956:function(e,n,t){"use strict";var a=(0,t(7378).createContext)(void 0);n.Z=a},297:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var a=t(7378);function o(e){var n=e.children,t=e.type;return a.createElement("span",{className:"badge badge--"+t},n)}},7586:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var a=t(7378),o=t(297),i="badgeGroup_2HOO";function r(e){var n=e.children;return a.createElement("span",{className:i},n)}function l(e){var n=e.backend,t=e.frontend,i=e.tooling;return a.createElement(r,null,n&&a.createElement(o.Z,{type:"warning"},"Backend"),t&&a.createElement(o.Z,{type:"success"},"Frontend"),i&&a.createElement(o.Z,{type:"primary"},"Tooling"))}},9284:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return p},contentTitle:function(){return u},metadata:function(){return m},toc:function(){return c},default:function(){return g}});var a=t(9603),o=t(120),i=(t(7378),t(5318)),r=t(7586),l=t(4535),s=t(517),d=["components"],p={title:"Configuration"},u=void 0,m={unversionedId:"config",id:"config",isDocsHomePage:!1,title:"Configuration",description:"Powerful convention based finder, loader, and manager of both configuration and ignore files. Will",source:"@site/docs/config.mdx",sourceDirName:".",slug:"/config",permalink:"/docs/config",editUrl:"https://github.com/milesj/boost/edit/master/website/docs/config.mdx",version:"current",frontMatter:{title:"Configuration"},sidebar:"docs",previous:{title:"Project",permalink:"/docs/common/project"},next:{title:"Crash reporting",permalink:"/docs/crash"}},c=[{value:"Installation",id:"installation",children:[]},{value:"Events",id:"events",children:[]},{value:"Setup",id:"setup",children:[{value:"Finder options",id:"finder-options",children:[]},{value:"Processor options",id:"processor-options",children:[]},{value:"Processing settings",id:"processing-settings",children:[]}]},{value:"Config files",id:"config-files",children:[{value:"File patterns",id:"file-patterns",children:[]},{value:"File formats",id:"file-formats",children:[]},{value:"Loading config files",id:"loading-config-files",children:[]},{value:"Enable extending",id:"enable-extending",children:[]},{value:"Enable overrides",id:"enable-overrides",children:[]}]},{value:"Ignore files",id:"ignore-files",children:[{value:"File patterns",id:"file-patterns-1",children:[]},{value:"Loading ignore files",id:"loading-ignore-files",children:[]}]}],f={toc:c};function g(e){var n=e.components,t=(0,o.Z)(e,d);return(0,i.kt)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)(r.Z,{backend:!0,tooling:!0,mdxType:"EnvBadges"}),(0,i.kt)("p",null,"Powerful convention based finder, loader, and manager of both configuration and ignore files. Will\nfind config files of multiple supported formats while traversing up the tree."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)(l.Z,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"NPM",value:"npm"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @boost/config\n"))),(0,i.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @boost/config\n")))),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Event"),(0,i.kt)("th",{parentName:"tr",align:null},"Arguments"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Configuration#onLoadedConfig")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ConfigFile<T>[]")),(0,i.kt)("td",{parentName:"tr",align:null},"Waterfall: Called after config files are loaded but before processed. Can modify config file list.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Configuration#onLoadedIgnore")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"IgnoreFile[]")),(0,i.kt)("td",{parentName:"tr",align:null},"Waterfall: Called after ignore files are loaded. Can modify ignore file list.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"Configuration#onProcessedConfig")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"T")),(0,i.kt)("td",{parentName:"tr",align:null},"Called after config files are loaded and processed.")))),(0,i.kt)("h2",{id:"setup"},"Setup"),(0,i.kt)("p",null,"Configuration in the context of this package encompasses 2 concepts: config files and ignore files.\nConfig files are a collection of settings (key-value pairs), while ignore files are a list of file\npath patterns and globs."),(0,i.kt)("p",null,"To utilize this functionality, we must extend the ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration")," class, and define a blueprint for\nthe structure of our config file (using ",(0,i.kt)("a",{parentName:"p",href:"/docs/common/contract"},"optimal"),"). This class will fulfill\nmultiple roles: managing, finding, loading, and processing of files."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Blueprint, Predicates } from '@boost/common';\nimport { Configuration } from '@boost/config';\n\n// Example structure\ninterface ConfigFile {\n    ast?: boolean;\n    cwd?: string;\n    debug?: boolean;\n    exclude?: string[];\n    include?: string[];\n    options?: object;\n}\n\nclass Manager extends Configuration<ConfigFile> {\n    blueprint({ array, bool, string, object }: Predicates): Blueprint<ConfigFile> {\n        return {\n            ast: bool(),\n            cwd: string(process.cwd()),\n            debug: bool(),\n            exclude: array(string()),\n            include: array(string()),\n            options: object(),\n        };\n    }\n}\n")),(0,i.kt)("p",null,'This class layer is designed to be "internal only", and should not be utilized by consumers\ndirectly. Instead, consumers should interact with an instance of the class, like so.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export default new Manager('boost');\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The string value passed to the constructor is the name of the config and ignore files, in camel\ncase format. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"boost.js")," and ",(0,i.kt)("inlineCode",{parentName:"p"},".boostignore"),".")),(0,i.kt)("h3",{id:"finder-options"},"Finder options"),(0,i.kt)("p",null,"To customize the config file finding and loading layer, call ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#configureFinder()"),"\nwithin ",(0,i.kt)("inlineCode",{parentName:"p"},"bootstrap()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"class Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        this.configureFinder({\n            extendsSetting: 'extends',\n            includeEnv: false,\n        });\n    }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"extendsSetting")," (",(0,i.kt)("inlineCode",{parentName:"li"},"string"),") - Name of the setting in which ",(0,i.kt)("a",{parentName:"li",href:"#enable-extending"},"config extending"),"\nis enabled."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"extensions")," (",(0,i.kt)("inlineCode",{parentName:"li"},"ExtType[]"),") - List of extensions, in order, to find config files within each\nfolder. Defaults to ",(0,i.kt)("a",{parentName:"li",href:"#file-formats"},"file format list"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"includeEnv")," (",(0,i.kt)("inlineCode",{parentName:"li"},"boolean"),") - Find and load environment based config files (using ",(0,i.kt)("inlineCode",{parentName:"li"},"NODE_ENV"),").\nDefaults to ",(0,i.kt)("inlineCode",{parentName:"li"},"true"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"loaders")," (",(0,i.kt)("inlineCode",{parentName:"li"},"{ [K in LoaderType]: Loader<T> }"),") - Mapping of loader functions by type. Defaults to\nnormal file type loaders."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"overridesSetting")," (",(0,i.kt)("inlineCode",{parentName:"li"},"string"),") - Name of the setting in which\n",(0,i.kt)("a",{parentName:"li",href:"#enable-overrides"},"config overriding")," is enabled.")),(0,i.kt)("h3",{id:"processor-options"},"Processor options"),(0,i.kt)("p",null,"To customize the config processing layer, call ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#configureProcessor()")," while within\n",(0,i.kt)("inlineCode",{parentName:"p"},"bootstrap()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"class Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        this.configureProcessor({\n            defaultWhenUndefined: false,\n        });\n    }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"defaultWhenUndefined")," (",(0,i.kt)("inlineCode",{parentName:"li"},"boolean"),") - When a setting has a value of ",(0,i.kt)("inlineCode",{parentName:"li"},"undefined"),", fallback to the\ndefault/initial value for that setting. Defaults to ",(0,i.kt)("inlineCode",{parentName:"li"},"true"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"validate")," (",(0,i.kt)("inlineCode",{parentName:"li"},"boolean"),") - Validate all settings within a config file before processing. Defaults to\n",(0,i.kt)("inlineCode",{parentName:"li"},"true"),".")),(0,i.kt)("h3",{id:"processing-settings"},"Processing settings"),(0,i.kt)("p",null,"When multiple config files are merged into a single config file, this is known as processing.\nProcessing happens automatically for each setting as we need to determine what the next setting\nvalue would be. By default, the following rules apply when the next and previous setting values are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Arrays"),": will be merged and deduped into a new array."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Objects"),": will be shallow merged (using spread) into a new object."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Primitives"),": next value will overwrite the previous value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"Undefined"),": will reset to initial value if ",(0,i.kt)("inlineCode",{parentName:"li"},"defaultWhenUndefined")," is true.")),(0,i.kt)("p",null,"If you would like to customize this process, you can define custom process handlers per setting with\n",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#addProcessHandler()"),". This method requires a setting name and handler function (which\nis passed the previous and next values)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"class Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        // Always use forward slashes\n        this.addProcessHandler('cwd', (prev, next) => next.replace(/\\\\/g, '/'));\n\n        // Deep merge options since they're dynamic\n        this.addProcessHandler('options', (prev, next) => deepMerge(prev, next));\n    }\n}\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Handlers may only be defined on root-level settings.")),(0,i.kt)("p",null,"To make this process even easier, we provide a handful of pre-defined handlers (below) that can be\nused for common scenarios (these handlers power the default rules mentioned above)."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mergeArray")," - Merges previous and next arrays into a new array while removing duplicates (using\n",(0,i.kt)("inlineCode",{parentName:"li"},"Set"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mergeExtends")," - Merges previous and next file paths (either a string or array of strings) into a\nnew list of file paths. This is useful if utilizing ",(0,i.kt)("a",{parentName:"li",href:"#enable-extending"},"config extending"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mergeObject")," - Shallow merges previous and next objects into a new object using object spread."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mergePlugins")," - Merges previous and next plugin configurations into an object. Plugin configs can\neither be a list of sources, or list of sources with flags/options (tuples), or a map of sources\nto flags/options. This is useful if utilizing the\n",(0,i.kt)("a",{parentName:"li",href:"/docs/plugin#configuration-files"},"plugin package"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"overwrite")," - Overwrite the previous value with the next value.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { mergePlugins } from '@boost/config';\n\nclass Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        // Using example from @boost/plugin documentation\n        this.addProcessHandler('renderers', mergePlugins);\n    }\n}\n")),(0,i.kt)("h2",{id:"config-files"},"Config files"),(0,i.kt)("p",null,"A config file is a file that explicitly defines settings (key-value pairs) according to a defined\nstructure."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Configuration files are designed to be serializable, so please use primitive, object, and array\nvalues only. Try to avoid non-serializable values like class instances.")),(0,i.kt)("h3",{id:"file-patterns"},"File patterns"),(0,i.kt)("p",null,"Config files are grouped into either the root or branch category. Root config files are located in a\n",(0,i.kt)("inlineCode",{parentName:"p"},".config")," folder in the root of a project (denoted by the current working directory). Branch config\nfiles are located within folders (at any depth) below the root, and are prefixed with a leading dot\n(",(0,i.kt)("inlineCode",{parentName:"p"},"."),")."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Root"),(0,i.kt)("th",{parentName:"tr",align:null},"Branch"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".config/<name>.<ext>")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".<name>.<ext>"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".config/<name>.<env>.<ext>")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".<name>.<env>.<ext>"))))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<name>")," - Name passed to your ",(0,i.kt)("inlineCode",{parentName:"li"},"Configuration")," instance (in camel case)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<env>")," - Current environment derived from ",(0,i.kt)("inlineCode",{parentName:"li"},"NODE_ENV"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<ext>")," - File extension supported by the defined ",(0,i.kt)("a",{parentName:"li",href:"#finder-options"},"loaders and extensions"),".")),(0,i.kt)("h3",{id:"file-formats"},"File formats"),(0,i.kt)("p",null,"Config files can be written in the formats below, and are listed in the order in which they're\nresolved (can customize with the ",(0,i.kt)("a",{parentName:"p",href:"#finder-options"},(0,i.kt)("inlineCode",{parentName:"a"},"extensions"))," option)."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".js")," - JavaScript. Will load with ",(0,i.kt)("a",{parentName:"li",href:"https://nodejs.org/api/esm.html#esm_enabling"},"CommonJS or ECMAScript modules")," depending on the\n",(0,i.kt)("inlineCode",{parentName:"li"},"package.json")," ",(0,i.kt)("inlineCode",{parentName:"li"},"type")," field. Defaults to CommonJS if not defined."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".json"),", ",(0,i.kt)("inlineCode",{parentName:"li"},".json5")," - JSON. Supports ",(0,i.kt)("a",{parentName:"li",href:"https://json5.org/"},"JSON5")," for both extensions."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".cjs")," - JavaScript using ",(0,i.kt)("a",{parentName:"li",href:"https://nodejs.org/api/esm.html#esm_enabling"},"CommonJS")," (",(0,i.kt)("inlineCode",{parentName:"li"},"require()"),"). ",(0,i.kt)("em",{parentName:"li"},"Supported by all Node.js versions.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".mjs")," - JavaScript using ",(0,i.kt)("a",{parentName:"li",href:"https://nodejs.org/api/esm.html#esm_enabling"},"ECMAScript modules")," (",(0,i.kt)("inlineCode",{parentName:"li"},"import"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"export"),"). ",(0,i.kt)("em",{parentName:"li"},"Requires Node.js\nv13.3+.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".ts")," - TypeScript. ",(0,i.kt)("em",{parentName:"li"},"Requires the ",(0,i.kt)("inlineCode",{parentName:"em"},"typescript")," package.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".yaml"),", ",(0,i.kt)("inlineCode",{parentName:"li"},".yml")," - YAML. ",(0,i.kt)("em",{parentName:"li"},"Does not support multi-document."))),(0,i.kt)("p",null,"Based on the file structure in the ",(0,i.kt)("a",{parentName:"p",href:"#setup"},"Setup")," section above, the config files can be\ndemonstrated as followed (excluding standard JavaScript since it's either CJS or MJS)."),(0,i.kt)(l.Z,{groupId:"file-format",defaultValue:"cjs",values:[{label:"JavaScript (CJS)",value:"cjs"},{label:"JavaScript (MJS)",value:"mjs"},{label:"TypeScript",value:"ts"},{label:"JSON",value:"json"},{label:"YAML",value:"yaml"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"cjs",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n    ast: false,\n    debug: true,\n    exclude: ['**/node_modules/**'],\n    include: ['src/**', 'tests/**'],\n    options: { experimental: true },\n};\n"))),(0,i.kt)(s.Z,{value:"mjs",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n    ast: false,\n    debug: true,\n    exclude: ['**/node_modules/**'],\n    include: ['src/**', 'tests/**'],\n    options: { experimental: true },\n};\n"))),(0,i.kt)(s.Z,{value:"ts",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import type { ConfigFile } from './types';\n\nconst config: ConfigFile = {\n    ast: false,\n    debug: true,\n    exclude: ['**/node_modules/**'],\n    include: ['src/**', 'tests/**'],\n    options: { experimental: true },\n};\n\nexport default config;\n"))),(0,i.kt)(s.Z,{value:"json",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "ast": false,\n    "debug": true,\n    "exclude": ["**/node_modules/**"],\n    "include": ["src/**", "tests/**"],\n    "options": { "experimental": true }\n}\n'))),(0,i.kt)(s.Z,{value:"yaml",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"ast: false\ndebug: true\nexclude:\n  - '**/node_modules/**'\ninclude:\n  - 'src/**'\n  - 'tests/**'\noptions:\n  experimental: true\n")))),(0,i.kt)("h3",{id:"loading-config-files"},"Loading config files"),(0,i.kt)("p",null,"Config files can be found and loaded with either the ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadConfigFromRoot()")," or\n",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadConfigFromBranchToRoot()")," methods -- both of which return a processed config\nobject that abides this structure."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"config")," (",(0,i.kt)("inlineCode",{parentName:"li"},"Required<T>"),") - All found and loaded config file contents merged and processed into a\nsingle config object."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"files")," - List of config files found and loaded.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"config")," (",(0,i.kt)("inlineCode",{parentName:"li"},"Partial<T>"),") - Config content of the file."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"path")," (",(0,i.kt)("inlineCode",{parentName:"li"},"Path"),") - Absolute path of the file."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"source")," (",(0,i.kt)("inlineCode",{parentName:"li"},"root | branch | overridden | extended"),") - The type of file.")))),(0,i.kt)("h4",{id:"lookup-resolution"},"Lookup resolution"),(0,i.kt)("p",null,"When the finder traverses through the file system and attempts to resolve config files within\neach/target folder, it does so using the lookup algorithm demonstrated below. Let's assume the\nfollowing:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The config file name is ",(0,i.kt)("inlineCode",{parentName:"li"},"boost"),"."),(0,i.kt)("li",{parentName:"ul"},"All file formats are supported, in their default lookup order (js, json, cjs, mjs, ts, json5,\nyaml, yml)."),(0,i.kt)("li",{parentName:"ul"},"The current environment is ",(0,i.kt)("inlineCode",{parentName:"li"},"development")," (the value of ",(0,i.kt)("inlineCode",{parentName:"li"},"NODE_ENV"),").")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"boost.js\nboost.development.js\nboost.json\nboost.development.json\nboost.cjs\nboost.development.cjs\nboost.mjs\nboost.development.mjs\nboost.ts\nboost.development.ts\nboost.json5\nboost.development.json5\nboost.yaml\nboost.development.yaml\nboost.yml\nboost.development.yml\n")),(0,i.kt)("p",null,"For each file format, we attempt to find the base config file, and an environment config file (if\n",(0,i.kt)("a",{parentName:"p",href:"#finder-options"},(0,i.kt)("inlineCode",{parentName:"a"},"includeEnv"))," is true). This allows for higher precendence config per environment.\nOnce a file is found, the lookup process is aborted, and the confg is returned."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Only 1 file format will be used per folder. Multiple file formats is not supported.")),(0,i.kt)("h4",{id:"from-root"},"From root"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadConfigFromRoot()")," will load the config file found in the root ",(0,i.kt)("inlineCode",{parentName:"p"},".config"),"\nfolder (typically 1 file). If no root path is provided, it defaults to process.cwd()."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="root/.config/boost.json"',title:'"root/.config/boost.json"'},'{\n    "debug": true\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const { config } = await manager.loadConfigFromRoot('/root');\n\n/*\n{\n  config: { debug: true },\n  files: [\n    {\n      config: { debug: true },\n      path: new Path('/root/.config/boost.json'),\n      source: 'root',\n    },\n  ],\n}\n*/\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Why are root config files located within a ",(0,i.kt)("inlineCode",{parentName:"p"},".config")," folder? In an effort to reduce the root\nconfig and dotfile churn that many projects suffer from, we're trying to push forward an idiomatic\nstandard that we hope many others will follow.")),(0,i.kt)("h4",{id:"from-branch"},"From branch"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadConfigFromBranchToRoot()")," method will load a config file from each folder\nwhile traversing upwards from the branch folder to the root folder. The found list is returned in\nreverse order so that the deepest branch can be used to overwrite the previous branch (or root)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="root/modules/features/.boost.mjs"',title:'"root/modules/features/.boost.mjs"'},"export default {\n    ast: true,\n};\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="root/modules/.boost.yaml"',title:'"root/modules/.boost.yaml"'},"options:\n  experimental: true\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="root/.config/boost.json"',title:'"root/.config/boost.json"'},'{\n    "debug": true\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const { config } = await manager.loadConfigFromBranchToRoot('/root/modules/features');\n\n/*\n{\n  config: {\n    ast: true,\n    debug: true,\n    options: {\n      experimental: true,\n    },\n  },\n  files: [\n    {\n      config: { debug: true },\n      path: new Path('/root/.config/boost.json'),\n      source: 'root',\n    },\n    {\n      config: {\n        options: {\n          experimental: true,\n        },\n      },\n      path: new Path('/root/modules/.boost.yaml'),\n      source: 'branch',\n    },\n    {\n      config: { ast: true },\n      path: new Path('/root/modules/features/.boost.mjs'),\n      source: 'branch',\n    },\n  ],\n}\n*/\n")),(0,i.kt)("h3",{id:"enable-extending"},"Enable extending"),(0,i.kt)("p",null,"Config extending enables consumers of your project to extend and merge with external config files\nusing file system paths or ",(0,i.kt)("a",{parentName:"p",href:"#presets"},"Node.js modules"),", with the current config file taking\nprecedence. With that being said, extending is ",(0,i.kt)("em",{parentName:"p"},"not")," enabled by default and must be configured for\nuse. To enable, define the ",(0,i.kt)("a",{parentName:"p",href:"#finder-options"},(0,i.kt)("inlineCode",{parentName:"a"},"extendsSetting"))," option with the name of a setting in\nwhich extending would be configured."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"class Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        this.configureFinder({\n            extendsSetting: 'extend',\n        });\n    }\n}\n")),(0,i.kt)("p",null,"Consumers may now extend external config files by defining a string or an array of strings for\n",(0,i.kt)("inlineCode",{parentName:"p"},"extend")," (name derived from the example above)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export default {\n    extend: ['./some/relative/path.js', 'npm-module'],\n    debug: false,\n};\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"File paths are relative to the file it's configured in.")),(0,i.kt)("h4",{id:"presets"},"Presets"),(0,i.kt)("p",null,"To extend from a Node.js module, we must use a preset. A preset is a\n",(0,i.kt)("a",{parentName:"p",href:"#file-formats"},"JavaScript config file")," located in the module root, named in the format of\n",(0,i.kt)("inlineCode",{parentName:"p"},"<name>.preset.js"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="npm-module/boost.preset.js"',title:'"npm-module/boost.preset.js"'},"module.exports = {\n    exclude: ['**/node_modules'],\n};\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Since the preset is JavaScript, it can be written in either CommonJS or ECMAScript format,\nassuming the ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," field has been set in ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"),".")),(0,i.kt)("h3",{id:"enable-overrides"},"Enable overrides"),(0,i.kt)("p",null,"Config overrides enables consumers of your project to define granular settings based on file path\nmatching; settings defined in this fashion would override their base settings. With that being said,\noverrides are ",(0,i.kt)("em",{parentName:"p"},"not")," enabled by default and must be configured for use. To enable, define the\n",(0,i.kt)("a",{parentName:"p",href:"#finder-options"},(0,i.kt)("inlineCode",{parentName:"a"},"overridesSetting"))," option with the name of a setting in which overrides would be\nconfigured."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"class Manager extends Configuration<ConfigFile> {\n    // ...\n\n    bootstrap() {\n        this.configureFinder({\n            overridesSetting: 'override',\n        });\n    }\n}\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Overrides are extracted ",(0,i.kt)("em",{parentName:"p"},"before")," configurations are processed, so a process handler is not\nrequired.")),(0,i.kt)("p",null,"Consumers may now define overrides in their config file by passing a list of items to the ",(0,i.kt)("inlineCode",{parentName:"p"},"override"),"\nsetting (name derived from the example above). Each item must abide the following structure:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"settings")," (",(0,i.kt)("inlineCode",{parentName:"li"},"Partial<T>"),") - Settings configured for this specific override. ",(0,i.kt)("em",{parentName:"li"},"(Required)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"include")," (",(0,i.kt)("inlineCode",{parentName:"li"},"string | string[]"),") - File path patterns/globs to match against. ",(0,i.kt)("em",{parentName:"li"},"(Required)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"exclude")," (",(0,i.kt)("inlineCode",{parentName:"li"},"string | string[]"),") - File path patterns/globs to ignore.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export default {\n    debug: false,\n    override: [\n        {\n            include: '*.test.ts',\n            settings: {\n                debug: true,\n            },\n        },\n    ],\n};\n")),(0,i.kt)("h2",{id:"ignore-files"},"Ignore files"),(0,i.kt)("p",null,"An ignore file is a standard text file that denotes files and folders to ignore\n(filter/exclude/etc), within the current directory, using matching globs and patterns."),(0,i.kt)("h3",{id:"file-patterns-1"},"File patterns"),(0,i.kt)("p",null,"Both root and branch level ignore files use the same file naming scheme. The file is prefixed with a\nleading dot (",(0,i.kt)("inlineCode",{parentName:"p"},"."),"), followed by the name passed to your ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration")," instance (in camel case), and\nsuffixed with ",(0,i.kt)("inlineCode",{parentName:"p"},"ignore"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Root"),(0,i.kt)("th",{parentName:"tr",align:null},"Branch"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".<name>ignore")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".<name>ignore"))))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The root ignore file is not located within the ",(0,i.kt)("inlineCode",{parentName:"p"},".config")," folder as ignore paths/patterns/globs\nmust be relative to the current directory.")),(0,i.kt)("h3",{id:"loading-ignore-files"},"Loading ignore files"),(0,i.kt)("p",null,"Ignore files can be found and loaded with either the ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadIgnoreFromRoot()")," or\n",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadIgnoreFromBranchToRoot()")," methods -- both of which return a list of ignore\nmetadata that abides this structure."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ignore")," (",(0,i.kt)("inlineCode",{parentName:"li"},"string[]"),") - List of all ignore patterns within the file (split on ",(0,i.kt)("inlineCode",{parentName:"li"},"\\n"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"path")," (",(0,i.kt)("inlineCode",{parentName:"li"},"Path"),") - Absolute path of the file."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"source")," (",(0,i.kt)("inlineCode",{parentName:"li"},"root | branch"),") - Whether the file is a root or branch file.")),(0,i.kt)("p",null,"To demonstrate this, let's assume the following file system."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"root/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 features/\n\u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u2514\u2500\u2500 .boostignore\n\u2502   \u251c\u2500\u2500 foo.ts\n\u2502   \u251c\u2500\u2500 bar.ts\n\u2502   \u2514\u2500\u2500 baz.ts\n\u2514\u2500\u2500 .boostignore\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="root/modules/features/.boostignore"',title:'"root/modules/features/.boostignore"'},"build/\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="root/.boostignore"',title:'"root/.boostignore"'},"*.log\n*.lock\n")),(0,i.kt)("h4",{id:"from-root-1"},"From root"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadIgnoreFromRoot()")," will load the ignore file found in the root folder\n(typically 1 file). If no root path is provided, it defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"process.cwd()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const list = await manager.loadIgnoreFromRoot('/root');\n\n/*\n[\n  {\n    ignore: ['*.log', '*.lock'],\n    path: new Path('/root/.boostignore'),\n    source: 'root',\n  },\n]\n*/\n")),(0,i.kt)("h4",{id:"from-branch-1"},"From branch"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Configuration#loadIgnoreFromBranchToRoot()")," method will load an ignore file from each folder\nwhile traversing upwards from the branch folder to the root folder. The found list is returned in\nreverse order so that the deepest branch can be used to overwrite the previous branch (or root)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const list = await manager.loadIgnoreFromBranchToRoot('/root/modules/features');\n\n/*\n[\n  {\n    ignore: ['*.log', '*.lock'],\n    path: new Path('/root'),\n    source: 'root',\n  },\n  {\n    ignore: ['build/'],\n    path: new Path('/root/modules/features/.boostignore'),\n    source: 'branch',\n  },\n]\n*/\n")))}g.isMDXComponent=!0},8944:function(e,n,t){"use strict";function a(e){var n,t,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=a(e[n]))&&(o&&(o+=" "),o+=t);else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}function o(){for(var e,n,t=0,o="";t<arguments.length;)(e=arguments[t++])&&(n=a(e))&&(o&&(o+=" "),o+=n);return o}t.d(n,{Z:function(){return o}})}}]);