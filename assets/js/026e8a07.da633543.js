"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9384],{5318:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return m}});var a=t(7378);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(t),m=r,g=c["".concat(s,".").concat(m)]||c[m]||d[m]||l;return t?a.createElement(g,o(o({ref:n},u),{},{components:t})):a.createElement(g,o({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=c;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},9798:function(e,n,t){t.d(n,{Z:function(){return o}});var a=t(7378),r=t(8944),l="tabItem_wHwb";function o(e){var n=e.children,t=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,o),hidden:t},n)}},3337:function(e,n,t){t.d(n,{Z:function(){return g}});var a=t(5773),r=t(7378),l=t(8944),o=t(3457),i=t(5595),s=t(6457),p="tabList_J5MA",u="tabItem_l0OV";function d(e){var n=e.className,t=e.block,i=e.selectedValue,s=e.selectValue,p=e.tabValues,d=[],c=(0,o.o5)().blockElementScrollPositionUntilNextRender,m=function(e){var n=e.currentTarget,t=d.indexOf(n),a=p[t].value;a!==i&&(c(n),s(a))},g=function(e){var n,t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":var a,r=d.indexOf(e.currentTarget)+1;t=null!=(a=d[r])?a:d[0];break;case"ArrowLeft":var l,o=d.indexOf(e.currentTarget)-1;t=null!=(l=d[o])?l:d[d.length-1]}null==(n=t)||n.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},n)},p.map((function(e){var n=e.value,t=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,key:n,ref:function(e){return d.push(e)},onKeyDown:g,onClick:m},o,{className:(0,l.Z)("tabs__item",u,null==o?void 0:o.className,{"tabs__item--active":i===n})}),null!=t?t:n)})))}function c(e){var n=e.lazy,t=e.children,a=e.selectedValue,l=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){var o=l.find((function(e){return e.props.value===a}));return o?(0,r.cloneElement)(o,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},l.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})})))}function m(e){var n=(0,i.Y)(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",p)},r.createElement(d,(0,a.Z)({},e,n)),r.createElement(c,(0,a.Z)({},e,n)))}function g(e){var n=(0,s.Z)();return r.createElement(m,(0,a.Z)({key:String(n)},e))}},5595:function(e,n,t){t.d(n,{Y:function(){return c}});var a=t(7378),r=t(5331),l=t(654),o=t(784),i=t(1819);function s(e){return function(e){var n,t;return null!=(n=null==(t=a.Children.map(e,(function(e){if(!e||(0,a.isValidElement)(e)&&(n=e.props)&&"object"==typeof n&&"value"in n)return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}(e).map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}}))}function p(e){var n=e.values,t=e.children;return(0,a.useMemo)((function(){var e=null!=n?n:s(t);return function(e){var n=(0,o.l)(e,(function(e,n){return e.value===n.value}));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function u(e){var n=e.value;return e.tabValues.some((function(e){return e.value===n}))}function d(e){var n=e.queryString,t=void 0!==n&&n,o=e.groupId,i=(0,r.k6)(),s=function(e){var n=e.queryString,t=void 0!==n&&n,a=e.groupId;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:t,groupId:o});return[(0,l._X)(s),(0,a.useCallback)((function(e){if(s){var n=new URLSearchParams(i.location.search);n.set(s,e),i.replace(Object.assign({},i.location,{search:n.toString()}))}}),[s,i])]}function c(e){var n,t,r,l,o=e.defaultValue,s=e.queryString,c=void 0!==s&&s,m=e.groupId,g=p(e),f=(0,a.useState)((function(){return function(e){var n,t=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!u({value:t,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+a.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}var r=null!=(n=a.find((function(e){return e.default})))?n:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:o,tabValues:g})})),b=f[0],h=f[1],k=d({queryString:c,groupId:m}),y=k[0],N=k[1],v=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:m}.groupId),t=(0,i.Nk)(n),r=t[0],l=t[1],[r,(0,a.useCallback)((function(e){n&&l.set(e)}),[n,l])]),w=v[0],T=v[1],x=function(){var e=null!=y?y:w;return u({value:e,tabValues:g})?e:null}();return(0,a.useLayoutEffect)((function(){x&&h(x)}),[x]),{selectedValue:b,selectValue:(0,a.useCallback)((function(e){if(!u({value:e,tabValues:g}))throw new Error("Can't select invalid tab value="+e);h(e),N(e),T(e)}),[N,T,g]),tabValues:g}}},297:function(e,n,t){t.d(n,{Z:function(){return r}});var a=t(7378);function r(e){var n=e.children,t=e.type;return a.createElement("span",{className:"badge badge--"+t},n)}},2723:function(e,n,t){t.d(n,{Z:function(){return u}});var a=t(7378),r=t(1884),l=t(6125),o=t(297),i="badgeGroup_syf7",s="apiLink_JWAN";function p(e){var n=e.children;return a.createElement("span",{className:i},n)}function u(e){var n=e.api,t=e.backend,i=e.frontend,u=e.tooling;return a.createElement(a.Fragment,null,n&&a.createElement(r.default,{className:s,to:n},"API ",a.createElement(l.Z,null)),a.createElement(p,null,t&&a.createElement(o.Z,{type:"warning"},"Backend"),i&&a.createElement(o.Z,{type:"success"},"Frontend"),u&&a.createElement(o.Z,{type:"primary"},"Tooling")))}},2355:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return d},default:function(){return b},frontMatter:function(){return u},metadata:function(){return c},toc:function(){return g}});var a=t(5773),r=t(808),l=(t(7378),t(5318)),o=t(2723),i=t(3337),s=t(9798),p=["components"],u={title:"Plugins"},d=void 0,c={unversionedId:"plugin",id:"plugin",title:"Plugins",description:"Plugin based architecture that supports module loading, custom types, scopes, and more.",source:"@site/docs/plugin.mdx",sourceDirName:".",slug:"/plugin",permalink:"/docs/plugin",draft:!1,editUrl:"https://github.com/milesj/boost/edit/master/website/docs/plugin.mdx",tags:[],version:"current",frontMatter:{title:"Plugins"},sidebar:"docs",previous:{title:"Pipelines",permalink:"/docs/pipeline"},next:{title:"Terminal utilities",permalink:"/docs/terminal"}},m={},g=[{value:"Installation",id:"installation",level:2},{value:"Preface",id:"preface",level:2},{value:"Registries",id:"registries",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Priority",id:"priority",level:3},{value:"Life cycles",id:"life-cycles",level:3},{value:"Modules",id:"modules",level:2},{value:"Naming guidelines",id:"naming-guidelines",level:3},{value:"Loading plugins",id:"loading-plugins",level:2},{value:"Tool instances",id:"tool-instances",level:3},{value:"Configuration files",id:"configuration-files",level:3},{value:"Ecosystem",id:"ecosystem",level:2}],f={toc:g};function b(e){var n=e.components,t=(0,r.Z)(e,p);return(0,l.kt)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)(o.Z,{backend:!0,tooling:!0,api:"/api/plugin",mdxType:"EnvBadges"}),(0,l.kt)("p",null,"Plugin based architecture that supports module loading, custom types, scopes, and more."),(0,l.kt)("h2",{id:"installation"},"Installation"),(0,l.kt)(i.Z,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"npm",value:"npm"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"yarn",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @boost/plugin\n"))),(0,l.kt)(s.Z,{value:"npm",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @boost/plugin\n")))),(0,l.kt)("h2",{id:"preface"},"Preface"),(0,l.kt)("p",null,"The plugin system is comprised of 2 parts -- one for projects or libraries that want plugins, and\nthe other for plugin authors. ",(0,l.kt)("a",{parentName:"p",href:"#registries"},"Project owners")," can integrate into the system using a\nregistry, which is based around the idea of loading plugins from third-party packages or file system\npaths. ",(0,l.kt)("a",{parentName:"p",href:"#plugins"},"Plugin authors")," can create and provide packages that register and hook into the\nproject."),(0,l.kt)("p",null,"Our system is generic and robust enough to be integrated into any and all projects, with the ability\nto handle multiple plugins in parallel through configuration and setting based approaches."),(0,l.kt)("h2",{id:"registries"},"Registries"),(0,l.kt)("p",null,'For project authors, we begin by defining a unique plugin type, like "renderer", "engine", "asset",\nor simply "plugin" if you\'re not looking to be creative. We can accomplish this with the\n',(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry"))," class, which requires a project name (used as a\n",(0,l.kt)("a",{parentName:"p",href:"#naming-guidelines"},"package prefix and scope"),"), plugin type name, and customizable options."),(0,l.kt)("p",null,'In our examples moving forward, we will use "renderer" as our plugin type.'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Registry, Pluggable } from '@boost/plugin';\n\nexport interface Renderable<T = unknown> extends Pluggable<T> {\n  render(): string | Promise<string>;\n}\n\nconst rendererRegistry = new Registry<Renderable>('boost', 'renderer', {\n  validate(plugin) {\n    if (typeof plugin.render !== 'function') {\n      throw new TypeError('Renderers require a `render()` method.');\n    }\n  },\n});\n\nexport default rendererRegistry;\n")),(0,l.kt)("p",null,"You may have noticed the ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/RegistryOptions#validate"},(0,l.kt)("inlineCode",{parentName:"a"},"validate"))," option above.\nThis option is required as it forces you to verify a plugin being loaded or registered abides the\ncontract you expect. In the example above, we expect all our renderers to have a ",(0,l.kt)("inlineCode",{parentName:"p"},"render"),' method,\notherwise, what would happen if an "engine" plugin was passed instead? Nothing good.'),(0,l.kt)("p",null,"Besides ",(0,l.kt)("inlineCode",{parentName:"p"},"validate"),", there are a handful of other options that can be passed, based on the\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/RegistryOptions"},(0,l.kt)("inlineCode",{parentName:"a"},"RegistryOptions"))," interface. For more information on life\ncycles, continue to the next ",(0,l.kt)("a",{parentName:"p",href:"#plugins"},"plugins")," chapter."),(0,l.kt)("h2",{id:"plugins"},"Plugins"),(0,l.kt)("p",null,"For both project owners and plugin authors, we keep talking about plugins, but what exactly is a\nplugin? In the context of this system, a plugin is either a plain object, or class instance that\nextends ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Plugin"},"Plugin"),", with both abiding a defined contract (the ",(0,l.kt)("inlineCode",{parentName:"p"},"validate")," option). A plugin\nmust also have a unique ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable#name"},(0,l.kt)("inlineCode",{parentName:"a"},"name"))," property, which is typically\nthe npm package name."),(0,l.kt)(i.Z,{groupId:"plugin-format",defaultValue:"class",values:[{label:"Class",value:"class"},{label:"Object",value:"object"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"class",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Plugin } from '@boost/plugin';\nimport { Renderable } from './registry';\n\nexport default class Renderer extends Plugin implements Renderable {\n  // Using private scope\n  readonly name = '@boost/renderer-example';\n\n  render() {\n    return 'Something rendered here?';\n  }\n}\n"))),(0,l.kt)(s.Z,{value:"object",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Renderable } from './registry';\n\nconst renderer: Renderable = {\n  // Using public scope\n  name: 'boost-renderer-example',\n\n  render() {\n    return 'Something rendered here?';\n  },\n};\n\nexport default renderer;\n")))),(0,l.kt)("p",null,"Now why would we use a class instead of an object, as an object seems much simpler? For 2 reasons,\nthe 1st being that ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Plugin"},(0,l.kt)("inlineCode",{parentName:"a"},"Plugin"))," extends from ",(0,l.kt)("a",{parentName:"p",href:"/docs/common#class-contracts"},(0,l.kt)("inlineCode",{parentName:"a"},"Contract")),", which\nallows the plugin to inherit options through its constructor. This automatically happens when\nloading plugins from a configuration file."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Blueprint, Schemas } from '@boost/common';\nimport { Plugin } from '@boost/plugin';\nimport { Renderable } from './registry';\n\nexport interface RendererOptions {\n  async?: boolean;\n}\n\nexport default class Renderer extends Plugin<unknown, RendererOptions> implements Renderable {\n  // ...\n\n  blueprint({ bool }: Schemas): Blueprint<RendererOptions> {\n    return {\n      async: bool(),\n    };\n  }\n}\n\n// Example\nconst renderer = new Renderer({ async: true });\n")),(0,l.kt)("p",null,"The 2nd reason is for TypeScript, as we can type our ",(0,l.kt)("a",{parentName:"p",href:"#tool-instances"},"tool")," that is passed to\n",(0,l.kt)("a",{parentName:"p",href:"#life-cycles"},"life cycles")," -- more specifically, the ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable"},(0,l.kt)("inlineCode",{parentName:"a"},"Pluggable"))," type. More\ninformation on the tool can be found in later chapters."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Plugin } from '@boost/plugin';\nimport { Renderable } from './registry';\nimport Tool from './Tool';\n\nexport default class Renderer extends Plugin<Tool> implements Renderable<Tool> {\n  // ...\n}\n")),(0,l.kt)("h3",{id:"priority"},"Priority"),(0,l.kt)("p",null,'After a plugin is loaded, the current plugins list is sorted based on priority. Priority is simply a\nnumber, in ascending order, that determines the order and precedence of plugins. Priority enables\nplugin authors and consumers to "mark" as high or low priority.'),(0,l.kt)("p",null,"Plugin authors can set a priority using the ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable#priority"},(0,l.kt)("inlineCode",{parentName:"a"},"priority")),"\nproperty."),(0,l.kt)(i.Z,{groupId:"plugin-format",defaultValue:"class",values:[{label:"Class",value:"class"},{label:"Object",value:"object"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"class",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Plugin } from '@boost/plugin';\nimport { Renderable } from './registry';\n\nexport default class Renderer extends Plugin implements Renderable {\n  readonly name = '@boost/renderer-example';\n\n  priority = 50;\n\n  render() {\n    return 'Something rendered here?';\n  }\n}\n"))),(0,l.kt)(s.Z,{value:"object",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Renderable } from './registry';\n\nconst renderer: Renderable = {\n  name: 'boost-renderer-example',\n\n  priority: 50,\n\n  render() {\n    return 'Something rendered here?';\n  },\n};\n\nexport default renderer;\n")))),(0,l.kt)("p",null,"While ",(0,l.kt)("a",{parentName:"p",href:"#loading-plugins"},"consumers can override")," the priority using the ",(0,l.kt)("inlineCode",{parentName:"p"},"priority")," option."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"rendererRegistry.load('boost-renderer-example', {}, { priority: 50 });\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"The default priority for all plugins is ",(0,l.kt)("inlineCode",{parentName:"p"},"100"),".")),(0,l.kt)("h3",{id:"life-cycles"},"Life cycles"),(0,l.kt)("p",null,"A life cycle is an optional method on a plugin that is executed at specific points in the life of a\nplugin. Currently, plugins support 2 life cycles,\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable#startup"},(0,l.kt)("inlineCode",{parentName:"a"},"startup"))," and\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable#shutdown"},(0,l.kt)("inlineCode",{parentName:"a"},"shutdown")),". Startup is executed after a plugin is loaded\nand validated, but before it's registered in the registry. Shutdown on the otherhand is executed\nbefore a plugin is unregistered from the registry."),(0,l.kt)("p",null,"All life cycles are asynchronouse and receive a ",(0,l.kt)("a",{parentName:"p",href:"#tool-instances"},"tool")," as its only argument."),(0,l.kt)(i.Z,{groupId:"plugin-format",defaultValue:"class",values:[{label:"Class",value:"class"},{label:"Object",value:"object"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"class",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Plugin } from '@boost/plugin';\nimport { Renderable } from './registry';\nimport Tool from './Tool';\n\nexport default class Renderer extends Plugin<Tool> implements Renderable<Tool> {\n  // ...\n\n  async startup(tool: Tool) {\n    // Do something\n  }\n\n  async shutdown(tool: Tool) {\n    // Do something\n  }\n}\n"))),(0,l.kt)(s.Z,{value:"object",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import Tool from './Tool';\n\nconst renderer = {\n  // ...\n\n  async startup(tool: Tool) {\n    // Do something\n  },\n\n  async shutdown(tool: Tool) {\n    // Do something\n  },\n};\n\nexport default renderer;\n")))),(0,l.kt)("h2",{id:"modules"},"Modules"),(0,l.kt)("p",null,"Typically plugins are represented as an npm package or file module for easy consumption. This\npattern is first class in Boost, but there are specific requirements to be followed. The 1st is that\nall plugin modules ",(0,l.kt)("em",{parentName:"p"},"must")," return a factory function from the default index import. Using a factory\nfunction provides the following benefits:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"The return value of the factory may change without breaking the import contract."),(0,l.kt)("li",{parentName:"ul"},"Option objects are passed to the factory, which allows implementors to handle it however they\nplease."),(0,l.kt)("li",{parentName:"ul"},"Runtime and boostrap based logic is encapsulated within the function."),(0,l.kt)("li",{parentName:"ul"},"Multiple instances can be created from a single imported package."),(0,l.kt)("li",{parentName:"ul"},"Asynchronous aware and compatible.")),(0,l.kt)("p",null,"Using our renderer examples, we would have the following factories. One sync and the other async."),(0,l.kt)(i.Z,{groupId:"plugin-format",defaultValue:"class",values:[{label:"Class (async)",value:"class"},{label:"Object (sync)",value:"object"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"class",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="@boost/renderer-example/src/index.ts"',title:'"@boost/renderer-example/src/index.ts"'},"import { Renderable } from './registry';\nimport Renderer, { RendererOptions } from './Renderer';\n\nexport default async function (options: RendererOptions): Renderable {\n  await someProcessThatNeedsToBeAwaited();\n\n  return new Renderer(options);\n}\n"))),(0,l.kt)(s.Z,{value:"object",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="boost-renderer-example/src/index.ts"',title:'"boost-renderer-example/src/index.ts"'},"import { RendererOptions, Renderable } from './registry';\n\nexport default function (options: RendererOptions): Renderable {\n  return {\n    name: 'boost-renderer-example',\n\n    render() {\n      if (options.async) {\n        return Promise.resolve('Ooo, this is a fancy render.');\n      }\n\n      return 'Something rendered here?';\n    },\n  };\n}\n")))),(0,l.kt)("h3",{id:"naming-guidelines"},"Naming guidelines"),(0,l.kt)("p",null,"You may have noticed in the examples above that we've been referencing both scoped and non-scoped\npackage names. All plugin packages follow the format of ",(0,l.kt)("inlineCode",{parentName:"p"},"<project>-<type>-<name>")," for public\nthird-party packages, and ",(0,l.kt)("inlineCode",{parentName:"p"},"@<project>/<type>-<name>")," for official project owner packages. A 3rd\nformat exists for public third-party packages that exist within a scope,\n",(0,l.kt)("inlineCode",{parentName:"p"},"@<scope>/<project>-<type>-<name>"),"."),(0,l.kt)("p",null,'If the plugin name is "example", and our project name is "boost", and our plugin type is "renderer",\nthe following package names are valid. ',(0,l.kt)("em",{parentName:"p"},"No other formats are supported.")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Package"),(0,l.kt)("th",{parentName:"tr",align:null},"Name"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Private/Owner"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@boost/renderer-example"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Public"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"boost-renderer-example"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Scoped public"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@scope/boost-renderer-example"))))),(0,l.kt)("p",null,"All name parts should be in kebab-case and abide the official\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/npm/validate-npm-package-name"},"npm package naming guidelines"),"."),(0,l.kt)("h2",{id:"loading-plugins"},"Loading plugins"),(0,l.kt)("p",null,"Plugins are either asynchronously loaded from an npm package, a relative file system path, or\nexplicitly passed using the ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry"))," class. The\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#load"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry#load()"))," method can be used to load a single plugin,\nwhile ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#loadMany"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry#loadMany()"))," will load multiple. Loading\naccepts 3 different formats, which are outlined with the examples below."),(0,l.kt)("p",null,"Passing a string will load based on module name or file path. Names can either be short (just the\nplugin name), or in the long fully qualified form (project, type, and plugin name). When using the\nshort form, the loader will attempt to find both the scoped (",(0,l.kt)("inlineCode",{parentName:"p"},"@boost/renderer-example"),") and\nnon-scoped packages (",(0,l.kt)("inlineCode",{parentName:"p"},"boost-renderer-example"),"), with scoped taking precedence."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"// Load by short module name\nconst renderer = await rendererRegistry.load('foo');\n\n// Load by long module name with options\nconst renderer = await rendererRegistry.load('boost-renderer-foo', { async: true });\n\n// Load by file path\nconst renderer = await rendererRegistry.load('./renderers/qux.js');\n")),(0,l.kt)("p",null,"You may also load many plugins in parallel, by passing an array of module names or plugin instances,\nor by passing an object of module names that map to booleans or options."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"// Load many with default options\nconst renderers = await rendererRegistry.loadMany([\n  'foo',\n  '@boost/renderer-bar',\n  '@scope/boost-renderer-baz',\n]);\n\n// Load many with custom options\nconst renderers = await rendererRegistry.loadMany({\n  foo: { async: true },\n  '@boost/renderer-bar': true, // Enabled\n  '@scope/boost-renderer-baz': false, // Disabled\n});\n")),(0,l.kt)("p",null,"And lastly, passing a plugin object directly is also supported."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"const renderer = await rendererRegistry.load({\n  name: '@scope/boost-renderer-baz',\n  render() {\n    return 'Hello world';\n  },\n});\n\n// Or\nconst renderer = await rendererRegistry.load(new Renderer());\n")),(0,l.kt)("p",null,"Loaded and registered plugins should then be accessed with\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#get"},(0,l.kt)("inlineCode",{parentName:"a"},"get()")),", ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#getMany"},(0,l.kt)("inlineCode",{parentName:"a"},"getMany()")),", or\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#getAll"},(0,l.kt)("inlineCode",{parentName:"a"},"getAll()")),", all of which check based on the plugin's ",(0,l.kt)("inlineCode",{parentName:"p"},"name"),"\nproperty."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"const renderer = rendererRegistry.get('boost-renderer-foo');\n")),(0,l.kt)("h3",{id:"tool-instances"},"Tool instances"),(0,l.kt)("p",null,"Most projects have a central object or class instance that powers their entire process, for\ninstance, Webpack has the ",(0,l.kt)("inlineCode",{parentName:"p"},"Compiler")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"Compilation")," instances. In Boost this is called a tool (as\nin developer or build tool)."),(0,l.kt)("p",null,"Tools are optional, but when defined, they're passed to plugin life cycles, so that plugins may\ninteract and integrate with them. For proper type-safety, the Tool type should be passed as a\ngeneric to ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry")),", ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Plugin"},(0,l.kt)("inlineCode",{parentName:"a"},"Plugin")),", and ",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/interface/Pluggable"},(0,l.kt)("inlineCode",{parentName:"a"},"Pluggable")),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import { Registry, Pluggable, Plugin } from '@boost/plugin';\nimport Tool from './Tool';\n\nexport interface Renderable<T> extends Pluggable<T> {\n  render(): string | Promise<string>;\n}\n\nclass Renderer<T> extends Plugin<T> implements Renderable<T> {}\n\nconst registry = new Registry<Renderable, Tool>(/* ... */);\nconst renderer = new Renderer<Tool>();\n")),(0,l.kt)("p",null,"If you have a tool instance, pass the tool as an option to\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#load"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry#load()"))," and\n",(0,l.kt)("a",{parentName:"p",href:"/api/plugin/class/Registry#loadMany"},(0,l.kt)("inlineCode",{parentName:"a"},"Registry#loadMany()")),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"import Tool from './Tool';\n\nconst tool = new Tool();\n\nawait registry.load('foo', {}, { tool });\nawait registry.loadMany(['foo', 'bar'], { tool });\n")),(0,l.kt)("h3",{id:"configuration-files"},"Configuration files"),(0,l.kt)("p",null,"The loader methods were built to support plugins defined in ",(0,l.kt)("a",{parentName:"p",href:"/docs/config"},"configuration files"),", as\nthis is a common use case. Settings to configure plugins are designed with 3 different formats in\nmind, all of which can be used together, and will merge into a valid final result."),(0,l.kt)("p",null,"The first is a simple array of plugin sources (module name or relative file path). When using a\nmodule, both long and short forms are supported."),(0,l.kt)(i.Z,{groupId:"package-manager",defaultValue:"json",values:[{label:"JSON",value:"json"},{label:"JS",value:"js"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"json",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "renderers": [\n    "foo", // @boost/renderer-foo, boost-renderer-foo\n    "@boost/renderer-bar",\n    "@scope/boost-renderer-baz",\n    "../custom/renderer.js"\n  ]\n}\n'))),(0,l.kt)(s.Z,{value:"js",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  renderers: [\n    'foo', // @boost/renderer-foo, boost-renderer-foo\n    '@boost/renderer-bar',\n    '@scope/boost-renderer-baz',\n    '../custom/renderer.js',\n  ],\n};\n")))),(0,l.kt)("p",null,"To expand upon the previous example, an individual plugin can be configured with options by passing\na tuple alongside the source. Plugins can also be disabled by passing a ",(0,l.kt)("inlineCode",{parentName:"p"},"false")," value."),(0,l.kt)(i.Z,{groupId:"package-manager",defaultValue:"json",values:[{label:"JSON",value:"json"},{label:"JS",value:"js"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"json",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "renderers": [\n    ["foo", { "async": true }],\n    "@boost/renderer-bar",\n    ["@scope/boost-renderer-baz", false], // Disabled\n    "../custom/renderer.js"\n  ]\n}\n'))),(0,l.kt)(s.Z,{value:"js",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  renderers: [\n    ['foo', { async: true }],\n    '@boost/renderer-bar',\n    ['@scope/boost-renderer-baz', false], // Disabled\n    '../custom/renderer.js',\n  ],\n};\n")))),(0,l.kt)("p",null,"The final format, which is quite advanced, is using an object that maps plugin sources to\nconfigurable options or flags (enable or disable the plugin)."),(0,l.kt)(i.Z,{groupId:"package-manager",defaultValue:"json",values:[{label:"JSON",value:"json"},{label:"JS",value:"js"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"json",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "renderers": {\n    "foo": { "async": true }, // Enabled with options\n    "@boost/renderer-bar": {}, // Enabled with empty options\n    "@scope/boost-renderer-baz": false, // Disabled\n    "../custom/renderer.js": true // Enabled\n  }\n}\n'))),(0,l.kt)(s.Z,{value:"js",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  renderers: {\n    foo: { async: true }, // Enabled with options\n    '@boost/renderer-bar': {}, // Enabled with empty options\n    '@scope/boost-renderer-baz': false, // Disabled\n    '../custom/renderer.js': true, // Enabled\n  },\n};\n")))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Configuration files are designed to be serializable, so passing class instances (Webpack/Rollup\nstyle) is not supported. It's also not necessary with our factory pattern!")),(0,l.kt)("h2",{id:"ecosystem"},"Ecosystem"),(0,l.kt)("p",null,"Below are a list of third-party projects and their current plugin implementations. These were used\nas a basis and reference for Boost's plugin system."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Project"),(0,l.kt)("th",{parentName:"tr",align:null},"Plugin pattern"),(0,l.kt)("th",{parentName:"tr",align:null},"Options pattern"),(0,l.kt)("th",{parentName:"tr",align:null},"Package names"),(0,l.kt)("th",{parentName:"tr",align:null},"Lifecycle events"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md#toc-writing-your-first-babel-plugin"},"Babel")),(0,l.kt)("td",{parentName:"tr",align:null},"Function that returns an object"),(0,l.kt)("td",{parentName:"tr",align:null},"Function argument"),(0,l.kt)("td",{parentName:"tr",align:null},"babel-plugin-foo, @babel/plugin-foo"),(0,l.kt)("td",{parentName:"tr",align:null},"pre(), post()")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://eslint.org/docs/developer-guide/working-with-plugins"},"ESLint")),(0,l.kt)("td",{parentName:"tr",align:null},"Object"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"eslint-plugin-foo"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://gulpjs.com/docs/en/getting-started/using-plugins"},"Gulp")),(0,l.kt)("td",{parentName:"tr",align:null},"Function that returns a stream"),(0,l.kt)("td",{parentName:"tr",align:null},"Function argument"),(0,l.kt)("td",{parentName:"tr",align:null},"N/A"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://parceljs.org/asset_types.html"},"Parcel asset")),(0,l.kt)("td",{parentName:"tr",align:null},"Class that extends ",(0,l.kt)("inlineCode",{parentName:"td"},"Asset")),(0,l.kt)("td",{parentName:"tr",align:null},"Constructor"),(0,l.kt)("td",{parentName:"tr",align:null},"parcel-asset-foo,",(0,l.kt)("br",null),"@parcel/asset-foo"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://parceljs.org/plugins.html"},"Parcel plugin")),(0,l.kt)("td",{parentName:"tr",align:null},"Function that binds events"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"parcel-plugin-foo, @parcel/plugin-foo"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://prettier.io/docs/en/plugins.html"},"Prettier")),(0,l.kt)("td",{parentName:"tr",align:null},"Named exports"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"prettier-plugin-foo, @prettier/plugin-foo, @scope/prettier-plugin-foo"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://rollupjs.org/guide/en/#plugins-overview"},"Rollup")),(0,l.kt)("td",{parentName:"tr",align:null},"Function that returns an object"),(0,l.kt)("td",{parentName:"tr",align:null},"Function argument"),(0,l.kt)("td",{parentName:"tr",align:null},"rollup-plugin-foo"),(0,l.kt)("td",{parentName:"tr",align:null},"Many")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://webpack.js.org/contribute/writing-a-plugin/"},"Webpack")),(0,l.kt)("td",{parentName:"tr",align:null},"Stand-alone class"),(0,l.kt)("td",{parentName:"tr",align:null},"Constructor (implementation dependent)"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"apply()")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://next.yarnpkg.com/advanced/plugin-tutorial"},"Yarn")),(0,l.kt)("td",{parentName:"tr",align:null},"Object with ",(0,l.kt)("inlineCode",{parentName:"td"},"factory()")," that returns an object"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"factory()")))))}b.isMDXComponent=!0}}]);