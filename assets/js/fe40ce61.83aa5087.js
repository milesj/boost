"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1576],{1172:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>u,toc:()=>h});var s=t(1948),r=t(3460),l=t(302),a=t(240),i=t(2548);const c={title:"Events"},o=void 0,u={id:"event",title:"Events",description:"A type-safe event system with multiple emitter patterns.",source:"@site/docs/event.mdx",sourceDirName:".",slug:"/event",permalink:"/docs/event",draft:!1,unlisted:!1,editUrl:"https://github.com/milesj/boost/edit/master/website/docs/event.mdx",tags:[],version:"current",frontMatter:{title:"Events"},sidebar:"docs",previous:{title:"Decorators",permalink:"/docs/decorators"},next:{title:"Logging",permalink:"/docs/log"}},d={},h=[{value:"Installation",id:"installation",level:2},{value:"Events",id:"events",level:2},{value:"Registering listeners",id:"registering-listeners",level:3},{value:"Unregistering listeners",id:"unregistering-listeners",level:3},{value:"Emitting events",id:"emitting-events",level:3},{value:"Scopes",id:"scopes",level:2},{value:"Event types",id:"event-types",level:2},{value:"Event",id:"event",level:3},{value:"BailEvent",id:"bailevent",level:3},{value:"ConcurrentEvent",id:"concurrentevent",level:3},{value:"WaterfallEvent",id:"waterfallevent",level:3}];function v(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.c,{backend:!0,frontend:!0,tooling:!0,api:"/api/event"}),"\n",(0,s.jsx)(n.p,{children:"A type-safe event system with multiple emitter patterns."}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(a.c,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"pnpm",value:"pnpm"},{label:"npm",value:"npm"}],children:[(0,s.jsx)(i.c,{value:"yarn",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add @boost/event\n"})})}),(0,s.jsx)(i.c,{value:"pnpm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pnpm add @boost/event\n"})})}),(0,s.jsx)(i.c,{value:"npm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @boost/event\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,s.jsxs)(n.p,{children:["The event system is built around individual ",(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})})," classes that can be instantiated in\nisolation, register and unregister their own listeners, and emit values by executing each listener\nwith arguments. There are multiple ",(0,s.jsx)(n.a,{href:"#event-types",children:"types of events"}),", so choose the best one for each\nuse case."]}),"\n",(0,s.jsxs)(n.p,{children:["To begin using events, instantiate an ",(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})})," with a unique name -- the name is purely for\ndebugging purposes."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { Event } from '@boost/event';\n\nconst event = new Event<[string]>('example');\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})}),"s utilize TypeScript generics for typing the arguments passed to listener functions.\nThis can be defined using a tuple or an array in the 1st generic slot. The 2nd slot is reserved for\n",(0,s.jsx)(n.a,{href:"#scopes",children:"scopes"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// One argument of type number\nnew Event<[number]>('foo');\n\n// Two arguments of type number and string\nnew Event<[number, string]>('bar');\n\n// Three arguments with the last item being optional\nnew Event<[object, boolean, string?]>('baz');\n\n// Array of any type or size\nnew Event<unknown[]>('foo');\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registering-listeners",children:"Registering listeners"}),"\n",(0,s.jsxs)(n.p,{children:["Listeners are simply functions that can be registered to an event using ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#listen",children:(0,s.jsx)(n.code,{children:"Event#listen()"})}),".\nThe same listener function reference will only be registered once."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"event.listen(listener);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["A listener can also be registered to execute only once, using ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#once",children:(0,s.jsx)(n.code,{children:"Event#once()"})}),", regardless of\nhow many times the event has been emitted."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"event.once(listener);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"unregistering-listeners",children:"Unregistering listeners"}),"\n",(0,s.jsxs)(n.p,{children:["A listener can be unregistered from an event using ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#unlisten",children:(0,s.jsx)(n.code,{children:"Event#unlisten()"})}),". The same listener\nreference used to register must also be used for unregistering."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"event.unlisten(listener);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To make this flow easier, a pre-configured unlistener is returned from ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#listen",children:(0,s.jsx)(n.code,{children:"Event#listen()"})}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const unlisten = event.listen(listener);\nunlisten();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"emitting-events",children:"Emitting events"}),"\n",(0,s.jsxs)(n.p,{children:["Emitting is the concept of executing all registered listeners with a set of arguments. This can be\nachieved through the ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#emit",children:(0,s.jsx)(n.code,{children:"Event#emit()"})})," method, which requires an array of values to pass to\neach listener as arguments."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"event.emit(['abc']);\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["The array values and its types should match the ",(0,s.jsx)(n.a,{href:"#events",children:"generics defined"})," on the constructor."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"scopes",children:"Scopes"}),"\n",(0,s.jsxs)(n.p,{children:["Scopes are a mechanism for restricting listeners to a unique subset. Scopes are defined as the 2nd\nargument to ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#listen",children:(0,s.jsx)(n.code,{children:"Event#listen()"})}),", ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#unlisten",children:(0,s.jsx)(n.code,{children:"#unlisten()"})}),", ",(0,s.jsx)(n.a,{href:"/api/event/class/Event#once",children:(0,s.jsx)(n.code,{children:"#once()"})}),", and\n",(0,s.jsx)(n.a,{href:"/api/event/class/Event#emit",children:(0,s.jsx)(n.code,{children:"#emit()"})}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"event.listen(listener);\nevent.listen(listener, 'foo');\nevent.listen(listener, 'bar');\n\n// Will only execute the 1st listener\nevent.emit([]);\n\n// Will only execute the 2nd listener\nevent.emit([], 'foo');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["A list of acceptable scope names can be passed as the 2nd generic slot to ",(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})}),",\notherwise all strings are allowed."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"new Event<[number], 'foo' | 'bar' | 'baz'>('event');\n"})}),"\n",(0,s.jsx)(n.h2,{id:"event-types",children:"Event types"}),"\n",(0,s.jsx)(n.p,{children:"There are 4 types of events that can be instantiated and emitted."}),"\n",(0,s.jsx)(n.h3,{id:"event",children:"Event"}),"\n",(0,s.jsxs)(n.p,{children:["Standard ",(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})})," that executes listeners in the order they were registered."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { Event } from '@boost/event';\n\nconst event = new Event<[string, number]>('standard');\n\nevent.listen(listener);\n\nevent.emit(['abc', 123]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"bailevent",children:"BailEvent"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/api/event/class/BailEvent",children:(0,s.jsx)(n.code,{children:"BailEvent"})})," is like ",(0,s.jsx)(n.a,{href:"/api/event/class/Event",children:(0,s.jsx)(n.code,{children:"Event"})})," but can bail the execution\nloop early if a listener returns ",(0,s.jsx)(n.code,{children:"false"}),". The emit method will return ",(0,s.jsx)(n.code,{children:"true"})," if a bail occurs."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { BailEvent } from '@boost/event';\n\nconst event = new BailEvent<[object]>('bail');\n\n// Will execute\nevent.listen(() => {});\n\n// Will execute and bail\nevent.listen(() => false);\n\n// Will not execute\nevent.listen(() => {});\n\nconst bailed = event.emit([{ example: true }]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"concurrentevent",children:"ConcurrentEvent"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/api/event/class/ConcurrentEvent",children:(0,s.jsx)(n.code,{children:"ConcurrentEvent"})})," executes listeners in parallel and returns\na promise with the result of all listeners."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { ConcurrentEvent } from '@boost/event';\n\nconst event = new ConcurrentEvent<[]>('parallel');\n\nevent.listen(doHeavyProcess);\nevent.listen(doBackgroundJob);\n\n// Async/await\nconst result = await event.emit([]);\n\n// Promise\nevent.emit([]).then((results) => {});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"waterfallevent",children:"WaterfallEvent"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/api/event/class/WaterfallEvent",children:(0,s.jsx)(n.code,{children:"WaterfallEvent"})})," executes each listener in order, passing the\nprevious listeners return value as an argument to the next listener. The final value is then\nreturned as a result."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { WaterfallEvent } from '@boost/event';\n\nconst event = new WaterfallEvent<number>('waterfall');\n\nevent.listen((num) => num * 2);\nevent.listen((num) => num * 3);\n\nconst result = event.emit(10); // 60\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"This event only accepts a single argument. The generic type should not be an array, as it types\nthe only argument and the return type."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(v,{...e})}):v(e)}},2548:(e,n,t)=>{t.d(n,{c:()=>a});t(6952);var s=t(8112);const r={tabItem:"tabItem_wHwb"};var l=t(1948);function a(e){let{children:n,hidden:t,className:a}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,s.c)(r.tabItem,a),hidden:t,children:n})}},240:(e,n,t)=>{t.d(n,{c:()=>v});var s=t(6952),r=t(8112),l=t(320),a=t(500),i=t(6576);const c={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var o=t(1948);function u(e){let{className:n,block:t,selectedValue:s,selectValue:a,tabValues:i}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.MV)(),h=e=>{const n=e.currentTarget,t=u.indexOf(n),r=i[t].value;r!==s&&(d(n),a(r))},v=e=>{var n;let t=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{var s;const n=u.indexOf(e.currentTarget)+1;t=null!=(s=u[n])?s:u[0];break}case"ArrowLeft":{var r;const n=u.indexOf(e.currentTarget)-1;t=null!=(r=u[n])?r:u[u.length-1];break}}null==(n=t)||n.focus()};return(0,o.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.c)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:l}=e;return(0,o.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>u.push(e),onKeyDown:v,onClick:h,...l,className:(0,r.c)("tabs__item",c.tabItem,null==l?void 0:l.className,{"tabs__item--active":s===n}),children:null!=t?t:n},n)}))})}function d(e){let{lazy:n,children:t,selectedValue:r}=e;const l=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===r));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,o.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function h(e){const n=(0,a.a)(e);return(0,o.jsxs)("div",{className:(0,r.c)("tabs-container",c.tabList),children:[(0,o.jsx)(u,{...e,...n}),(0,o.jsx)(d,{...e,...n})]})}function v(e){const n=(0,i.c)();return(0,o.jsx)(h,{...e,children:(0,a.A)(e.children)},String(n))}},500:(e,n,t)=>{t.d(n,{A:()=>o,a:()=>v});var s=t(6952),r=t(7976),l=t(2508),a=t(440),i=t(2484),c=t(900);function o(e){var n,t;return null!=(n=null==(t=s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function u(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=null!=n?n:function(e){return o(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:r}}=e;return{value:n,label:t,attributes:s,default:r}}))}(t);return function(e){const n=(0,i.w)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function d(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:t}=e;const l=(0,r.Uz)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,a._M)(i),(0,s.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(l.location.search);n.set(i,e),l.replace({...l.location,search:n.toString()})}),[i,l])]}function v(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,a=u(e),[i,o]=(0,s.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:s}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+s.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const r=null!=(n=s.find((e=>e.default)))?n:s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[v,p]=h({queryString:t,groupId:r}),[m,x]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[r,l]=(0,c.IN)(t);return[r,(0,s.useCallback)((e=>{t&&l.set(e)}),[t,l])]}({groupId:r}),f=(()=>{const e=null!=v?v:m;return d({value:e,tabValues:a})?e:null})();(0,l.c)((()=>{f&&o(f)}),[f]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!d({value:e,tabValues:a}))throw new Error("Can't select invalid tab value="+e);o(e),p(e),x(e)}),[p,x,a]),tabValues:a}}},5392:(e,n,t)=>{t.d(n,{c:()=>r});var s=t(1948);function r(e){let{children:n,type:t}=e;return(0,s.jsx)("span",{className:"badge badge--"+t,children:n})}},302:(e,n,t)=>{t.d(n,{c:()=>o});var s=t(4308),r=t(3752),l=t(5392);const a={badgeGroup:"badgeGroup_syf7",apiLink:"apiLink_JWAN"};var i=t(1948);function c(e){let{children:n}=e;return(0,i.jsx)("span",{className:a.badgeGroup,children:n})}function o(e){let{api:n,backend:t,frontend:o,tooling:u}=e;return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)(s.default,{className:a.apiLink,to:n,children:["API ",(0,i.jsx)(r.c,{})]}),(0,i.jsxs)(c,{children:[t&&(0,i.jsx)(l.c,{type:"warning",children:"Backend"}),o&&(0,i.jsx)(l.c,{type:"success",children:"Frontend"}),u&&(0,i.jsx)(l.c,{type:"primary",children:"Tooling"})]})]})}},3460:(e,n,t)=>{t.d(n,{I:()=>i,M:()=>a});var s=t(6952);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);